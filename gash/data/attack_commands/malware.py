import time
import random

class MalwareCommands:
    def __init__(self, state):
        self.commands = {
            'autorun': self.command_nop,
            'start': self.command_start1,
            'start2': self.command_start2,
            'start3': self.command_start3,
            'start.sh': self.command_start_sh1,
            'go.sh': self.command_go_sh1,
            'bash': self.command_bash,
            'a': self.command_a,
            'ss': self.command_ss,
        }
        self.state = state

    def command_nop(self, command, client_ip):
        pass

    def command_start1(self, command, client_ip):
        output = ''
        output += '=====>Created by PuFoS<====='
        output += '++++++ *This is a private archive* ++++++++'
        output += 'Example: ./start channel'
        output += 'P.S: WITHOUT HASH (#)!'
        return output

    def command_start2(self, command, client_ip):
        output = ''
        output += 'Example: ./start channel (without hash)'
        return output

    def command_start3(self, command, client_ip):
        output = ''
        output += '####################################################################'
        output += '#                               ______'
        output += '#                            .-.      .-.'
        output += '#                           /            \\'
        output += '#                          |     zRR      |'
        output += '#                          |,  .-.  .-.  ,|'
        output += '#                          | )(z_/  \z_)( |'
        output += '#                          |/     /\     \|'
        output += '#                  _       (_     ^^     _)'
        output += '#          _\ ____) \_______\__|IIIIII|__/_________________________'
        output += '#         (_)[___]\{\}<________|-\IIIIII/-|__zRR__zRR__zRR___________\\'
        output += '#           /     )_/        \          /'
        output += '#                             \ ______ /'
        output += '#                         SCANER PRIVAT'
        output += '#             SCANNER USED ONLY BY THE zRRTEAM'
        output += '#            THE SCANNER CONTAINS A 3-MEGABYTE PASS_FILE!!'
        output += '####################################################################'
        return output

    def command_start_sh1(self, command, client_ip):
        return 'Enjoy FloodBot based on OverKill\n'

    def command_go_sh1(self, command, client_ip):
        if len(command) <= 1:
            return 'A must be between 1 and 254'
        else:
            output = ''
            output += f'scanning network {command[1]}.*\n'
            output += 'usec: 30000, burst packets 50\n'
            output += 'using interface eth0\n'
            output += 'using "(tcp[tcpflags]=0x12) and (src port 22) and (dst port 15232)" as pcap filter\n'
            output += 'my detected ip on eth0 is 127.0.0.1\n'
            output += 'capturing process started pid 2259\n'
            output += 'All my \\033[31mlove\\033[0m for \\033[32mDiavola\\033[0m!!!!!!\n'
            return output

    def command_bash(self, command, client_ip):
        output = ''
        output += 'EnergyMech 2.9.3, May 16th, 2003\n'
        output += 'Compiled on Mar  4 2005 15:06:49\n'
        output += 'Features: DBG, LNE, SEE, LNK, TEL, PIP, DYN, ALS, SEF\n'
        return output

    def command_a(self, command, client_ip):
        if len(command) <= 1:
            return 'usage: ./a <b class>'
        output = ''
        output += '\\033[1;31m\\xAB\\033[1;32m Created bY MaLa \\033[1;31m\\xBB\\033[0m\n'
        output += 'I\'M TRYING TO GIVE LIFE TO CYBERNETICS\n'
        output += f'# scanning: {command[1]} (total: 0) (0.01%% done)'
        return output

    def command_ss(self, command, client_ip):
        if len(command) <= 1:
            return 'usage: ./ss <port> [-a <a class> | -b <b class>] [-i <interface] [-s <speed>]'
        output = ''
        output += 'usec: 1000000, burst packets 50\n'
        output += 'using "(tcp[tcpflags]=0x12) and (src port 22) and (dst port 38659)" as pcap filter\n'
        output += 'my detected ip on eth0 is 127.0.0.1\n'
        output += 'capturing process started pid 2282\n'
        return output

# vim: set sw=4 et tw=0: